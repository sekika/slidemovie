---
layout: page
title: 使い方 (ワークフロー)
lang: ja
nav_order: 3
parent: はじめに
---

# 標準的なワークフロー

動画の作成は、明確に分かれた4つのステップで行います。このワークフローにより、面倒な作業は自動化しつつ、コンテンツとデザインを完全にコントロールできます。

## ステップ 1: Markdown ファイルの作成

`project_name.md` という名前で新しいファイルを作成します。このファイルが、スライドの内容とナレーション原稿の両方の役割を果たします。

### 記述ルール
1.  **見出し**: 各スライドのタイトルには レベル1見出し (`# タイトル`) を使います。
2.  **内容**: スライドに表示するテキストには箇条書きを使います。
3.  **原稿**: ナレーションには `::: notes` ブロックを使います。
4.  **空行**: **重要！** `::: notes` の前には必ず空行を1つ以上入れてください。

### ファイルの例 (`demo.md`)

```markdown
# slidemovie の紹介

- 動画作成を自動化
- Markdown + PowerPoint
- AI ナレーション

::: notes
slidemovie の紹介へようこそ。このツールを使うと、Markdown と PowerPoint を組み合わせて、AI ナレーション付きの動画を自動的に作成できます。
:::

# 仕組み

1. Markdown を書く
2. PPTX を生成
3. デザインを編集
4. 動画を出力

::: notes
プロセスはシンプルです。まず、Markdown で原稿を書きます。次に、PowerPoint ファイルを生成します。PowerPoint のデザイナー機能で見た目を整えたら、コマンド一つで動画をビルドします。
:::
```

## ステップ 2: ドラフト PowerPoint の生成

ターミナルを開き、Markdown ファイルがあるフォルダに移動します。`-p` (pptx) オプションを付けて以下のコマンドを実行します。

```bash
# 書式: slidemovie [プロジェクト名] -p
slidemovie demo -p
```

これにより、`demo.md` を読み込んで `demo.pptx` が作成されます。

*   **注意**: この段階では、PowerPoint ファイルは非常に簡素（白い背景に黒い文字）ですが、正常です。

## ステップ 3: デザインの編集

ここだけが手作業のステップです。人間の創造性を発揮しましょう。

1.  `demo.pptx` を **Microsoft PowerPoint** で開きます。
2.  **「デザイナー」** ペインを開きます（通常は「ホーム」または「デザイン」タブにあります）。
3.  各スライドをクリックし、AI が提案するプロフェッショナルなデザインを選択します。
4.  （任意）画像の追加、フォントの変更、色の調整などを行います。

### 重要な注意点
*   **スライドの順番を変えないでください。**
*   **スライドを削除しないでください。**
*   **PowerPoint 上で新しいスライドを追加しないでください。**

プログラムは、Markdown の構造に基づいて音声とスライドを紐付けています。PowerPoint 側でスライド数を変更すると、同期が崩れてしまいます。スライドの追加や削除が必要な場合は、まず **Markdown ファイル** を編集し、ステップ2を再実行してください（注意: デザインはリセットされるため、原稿は早めに確定させることをお勧めします）。

## ステップ 4: 動画の生成

きれいな PowerPoint ファイルを上書き保存したら、`-v` (video) オプションを付けてビルドコマンドを実行します。

```bash
# 書式: slidemovie [プロジェクト名] -v
slidemovie demo -v
```

プログラムは以下の処理を行います：
1.  Markdown のノートを読み込み、音声ファイル (WAV) を生成します。
2.  PowerPoint のスライドを画像 (PNG) に変換します。
3.  これらを組み合わせて個別のスライド動画を作ります。
4.  すべてを結合して1本の最終的な動画にします。

### 出力先
完成した動画は以下に保存されます：
`./movie/demo/demo.mp4`

---

## サブプロジェクト（階層モード）

プロジェクトをフォルダごとに整理したい場合は、`--sub` オプションを使用できます。

**フォルダ構成:**
```text
ParentProject/
  ├── ChildA/
  │   └── ChildA.md
  └── ChildB/
      └── ChildB.md
```

**コマンド:**
```bash
slidemovie ParentProject --sub ChildA -v
```
